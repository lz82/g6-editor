!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports.g6editor=t():e.g6editor=t()}(this,(function(){return(this.webpackJsonpg6editor=this.webpackJsonpg6editor||[]).push([[0],{2:function(e,t,n){e.exports={home:"home--1rW0p","content-wrapper":"content-wrapper--1s7me","tool-box":"tool-box--1zfay",node:"node--2dKjL","node-start":"node-start--34dXH","node-common":"node-common--2xb54","node-juge":"node-juge--33Xk-","editor-wrapper":"editor-wrapper--oOLko","canvas-wrapper":"canvas-wrapper--1_gBK","info-wrapper":"info-wrapper--KyDG_","minimap-container":"minimap-container--3GEQi","info-editor":"info-editor--3MHIM",row:"row--3Tcjj","btn-wrapper":"btn-wrapper--3biwx"}},24:function(e,t,n){e.exports={"drop-container":"drop-container--2Ajpm"}},27:function(e,t,n){n(28),e.exports=n(49)},48:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrap",(function(){return M})),n.d(t,"mount",(function(){return F})),n.d(t,"unmount",(function(){return A}));var a=n(6),o=n.n(a),r=n(15),i=n(0),c=n.n(i),l=n(18),d=n.n(l),s=n(51),u=n(25),p=n(11),m=n(5),f=n(16),g=n.n(f),v=n(7),h=n.n(v),E=n(52),b={cursor:"move"},y=function(e){var t=e.name,n=e.children,a=e.onDragEnd,o=Object(E.a)({item:{name:t,type:"DragItem"},collect:function(e){return{isDragging:e.isDragging()}},end:function(e,t){var n=t.getDropResult();e&&n&&a&&a(e,n.position)}}),r=Object(m.a)(o,2),i=r[0].isDragging,l=r[1],d=i?.4:1;return c.a.createElement("li",{ref:l,style:Object(p.a)({},b,{opacity:d})},n)},k=n(53),w=n(24),j=n.n(w),D=function(e){var t=e.children,n=Object(k.a)({accept:"DragItem",drop:function(e,t){return{item:e,position:t.getSourceClientOffset()}},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),a=Object(m.a)(n,2),o=a[0],r=(o.canDrop,o.isOver,a[1]);return c.a.createElement("div",{className:j.a["drop-container"],ref:r},t)},I=n(2),O=n.n(I),x=1,N=function(){var e=Object(i.useRef)(null),t=Object(i.useRef)(null),n=Object(i.useRef)(),a=Object(i.useState)({id:"",node:null,label:""}),o=Object(m.a)(a,2),r=o[0],l=o[1],d=Object(i.useState)({nodes:[],edges:[]}),s=Object(m.a)(d,2),u=s[0];s[1];h.a.registerBehavior("drag-point-add-edge",{getEvents:function(){return{click:"onMouseClick",mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp","node:click":"onNodeClick","edge:click":"onEdgeClick"}},onMouseClick:function(e){e.preventDefault(),e.item||l({id:"",node:null,label:""})},onMouseDown:function(e){e.preventDefault();var t=e.item;if(t&&e.target.get("className").startsWith("link-point")){var n=this.graph,a=t.getModel();this.addingEdge||this.edge||(this.edge=n.addItem("edge",{source:a.id,target:a.id}),this.addingEdge=!0)}},onMouseMove:function(e){e.preventDefault();var t={x:e.x,y:e.y};this.addingEdge&&this.edge&&this.graph.updateItem(this.edge,{target:t})},onMouseUp:function(e){e.preventDefault();var t=e.item,n=this.graph;if(t&&!t.destroyed&&"node"===t.getType()){var a=t.getModel();console.log(a),this.addingEdge&&this.edge&&(n.updateItem(this.edge,{target:a.id}),this.edge=null,this.addingEdge=!1)}else this.addingEdge&&this.edge&&(n.removeItem(this.edge),this.edge=null,this.addingEdge=!1)},onNodeClick:function(e){e.preventDefault();var t=this.graph,n=e.item;if(n){t.findAllByState("node","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.findAllByState("edge","click").forEach((function(e){t.setItemState(e,"click",!1)})),console.log("to click item",n),t.setItemState(n,"click",!0);var a=n.getModel();l({id:a.id,node:n,label:a.label})}},onEdgeClick:function(e){e.preventDefault();var t=this.graph,n=e.item;t.findAllByState("node","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.findAllByState("edge","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.setItemState(n,"click",!0);var a=n.getModel();console.log(a),l({id:a.id,node:n,label:a.label||""})}}),Object(i.useEffect)((function(){var a,o,r=new v.Minimap({container:t.current,size:[200,160]}),i=new v.Grid,c=(new v.ToolBar,new v.Menu({getContent:function(e){return console.log("graph",e),"<span>\u5220\u9664</span>"},handleMenuClick:function(e,t){var a,o=t.getID(),r=t.getType();if("edge"===r)null===(a=n.current)||void 0===a||a.removeItem(t);else if("node"===r){var i,c,l=[];null===(i=n.current)||void 0===i||i.getEdges().forEach((function(e){e.getTarget().getID()!==o&&e.getSource().getID()!==o||l.push(e)})),console.log(l),l.forEach((function(e){var t;null===(t=n.current)||void 0===t||t.removeItem(e)})),null===(c=n.current)||void 0===c||c.removeItem(t)}},offsetX:16,offsetY:40,itemTypes:["node","edge"]}));n.current=new h.a.Graph({container:e.current,enabledStack:!0,maxStep:20,width:(null===(a=e.current)||void 0===a?void 0:a.scrollWidth)||1e3,height:(null===(o=e.current)||void 0===o?void 0:o.scrollHeight)||800,layout:{type:"dagre",rankdir:"TB",ranksep:30,"\u7c7b\u578b":30},plugins:[i,r,c],modes:{default:["drag-node","drag-point-add-edge"]},defaultNode:{style:{fill:"#FFF"},linkPoints:{top:!0,right:!0,bottom:!0,left:!0,size:10,fill:"#fff"}},nodeStateStyles:{click:{fill:"#C6E5FF"}},defaultEdge:{type:"polyline",style:{stroke:"#F6BD16",lineAppendWidth:10}},edgeStateStyles:{click:{lineWidth:5}}}),n.current.data(u),n.current.render()}),[u]);var f=function(e,t){if(t&&t.x>160&&t.y>50){var a,o="id-".concat(x++),r="common"===(c=e.name)?{type:"circle",size:80,style:{stroke:"blue",fill:"#FFF"}}:"start"===c?{type:"rect",size:[80,40],style:{fill:"#FFF",stroke:"red"}}:"juge"===c?{type:"diamond",size:80,style:{fill:"#FFF",stroke:"yellow"}}:void 0,i=Object(p.a)({},r,{id:o,x:t.x-120,y:t.y-10,anchorPoints:[[.5,0],[1,.5],[.5,1],[0,.5]],label:e.name});null===(a=n.current)||void 0===a||a.addItem("node",i)}var c};return c.a.createElement("div",{className:O.a.home},c.a.createElement("header",null,"\u6d41\u7a0b\u7f16\u8f91\u5668 \xa0\xa0\xa0",c.a.createElement("button",{onClick:function(){if(n.current){console.log(n.current.save());var e=n.current.save();n.current.read(e)}}},"\u5bf9\u9f50"),"\xa0\xa0",c.a.createElement("button",{onClick:function(){var e;console.log(null===(e=n.current)||void 0===e?void 0:e.save())}},"show Data")),c.a.createElement("div",{className:O.a["content-wrapper"]},c.a.createElement("div",{className:O.a["tool-box"]},c.a.createElement("ul",null,c.a.createElement(y,{name:"start",onDragEnd:f},c.a.createElement("div",{className:g()(O.a["node-start"],O.a.node)},"\u8d77\u70b9")),c.a.createElement(y,{name:"common",onDragEnd:f},c.a.createElement("div",{className:g()(O.a["node-common"],O.a.node)},"\u5e38\u89c4")),c.a.createElement(y,{name:"juge",onDragEnd:f},c.a.createElement("div",{className:g()(O.a["node-juge"],O.a.node)},c.a.createElement("span",null,"\u5224\u65ad"))))),c.a.createElement("div",{id:"editor-wrapper",className:O.a["editor-wrapper"]},c.a.createElement(D,null,c.a.createElement("div",{className:O.a["canvas-wrapper"],ref:e}))),c.a.createElement("div",{className:O.a["info-wrapper"]},c.a.createElement("div",{ref:t,className:"minimap-container"}),r.id?c.a.createElement("div",{className:O.a["info-editor"]},c.a.createElement("h4",null,"\u7f16\u8f91"),c.a.createElement("div",{className:O.a.row},c.a.createElement("label",null,"\u8282\u70b9\u540d\u79f0:"),c.a.createElement("input",{value:r.label,onChange:function(e){l(Object(p.a)({},r,{label:e.target.value}))}})),c.a.createElement("div",{className:O.a["btn-wrapper"]},c.a.createElement("button",{onClick:function(e){var t;e.preventDefault(),null===(t=n.current)||void 0===t||t.updateItem(r.node,{label:r.label})}},"\u4fdd\u5b58"))):null)))};n(47),n(48);function S(){d.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(s.a,{backend:u.a},c.a.createElement(N,null))),document.getElementById("g6-root"))}function M(e){return C.apply(this,arguments)}function C(){return(C=Object(r.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("react app bootstraped",t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){return B.apply(this,arguments)}function B(){return(B=Object(r.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.token,a=t.history,console.log(n),setTimeout((function(){a.push("/admin/user/list")}),3e3),S();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return T.apply(this,arguments)}function T(){return(T=Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d.a.unmountComponentAtNode(document.getElementById("g6-root"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.__POWERED_BY_QIANKUN__||S()}},[[27,1,2]]])}));
//# sourceMappingURL=main.ffd9246b.chunk.js.map