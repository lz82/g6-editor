(this["webpackJsonpg6-editor"]=this["webpackJsonpg6-editor"]||[]).push([[0],{2:function(e,t,n){e.exports={home:"home--1rW0p","content-wrapper":"content-wrapper--1s7me","tool-box":"tool-box--1zfay",node:"node--2dKjL","node-start":"node-start--34dXH","node-common":"node-common--2xb54","node-juge":"node-juge--33Xk-","editor-wrapper":"editor-wrapper--oOLko","canvas-wrapper":"canvas-wrapper--1_gBK","info-wrapper":"info-wrapper--KyDG_","minimap-container":"minimap-container--3GEQi","info-editor":"info-editor--3MHIM",row:"row--3Tcjj","btn-wrapper":"btn-wrapper--3biwx"}},22:function(e,t,n){e.exports={"drop-container":"drop-container--2Ajpm"}},25:function(e,t,n){n(26),e.exports=n(46)},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(20),i=n.n(r),l=n(48),c=n(23),d=n(10),s=n(5),u=n(14),m=n.n(u),g=n(6),p=n.n(g),f=n(49),v={cursor:"move"},h=function(e){var t=e.name,n=e.children,a=e.onDragEnd,r=Object(f.a)({item:{name:t,type:"DragItem"},collect:function(e){return{isDragging:e.isDragging()}},end:function(e,t){var n=t.getDropResult();e&&n&&a&&a(e,n.position)}}),i=Object(s.a)(r,2),l=i[0].isDragging,c=i[1],u=l?.4:1;return o.a.createElement("li",{ref:c,style:Object(d.a)({},v,{opacity:u})},n)},E=n(50),b=n(22),k=n.n(b),y=function(e){var t=e.children,n=Object(E.a)({accept:"DragItem",drop:function(e,t){return{item:e,position:t.getSourceClientOffset()}},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),a=Object(s.a)(n,2),r=a[0],i=(r.canDrop,r.isOver,a[1]);return o.a.createElement("div",{className:k.a["drop-container"],ref:i},t)},w=n(2),D=n.n(w),j=1,I=function(){var e=Object(a.useRef)(null),t=Object(a.useRef)(null),n=Object(a.useRef)(),r=Object(a.useState)({id:"",node:null,label:""}),i=Object(s.a)(r,2),l=i[0],c=i[1],u=Object(a.useState)({nodes:[],edges:[]}),f=Object(s.a)(u,2),v=f[0];f[1];p.a.registerBehavior("drag-point-add-edge",{getEvents:function(){return{click:"onMouseClick",mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp","node:click":"onNodeClick","edge:click":"onEdgeClick"}},onMouseClick:function(e){e.preventDefault(),e.item||c({id:"",node:null,label:""})},onMouseDown:function(e){e.preventDefault();var t=e.item;if(t&&e.target.get("className").startsWith("link-point")){var n=this.graph,a=t.getModel();this.addingEdge||this.edge||(this.edge=n.addItem("edge",{source:a.id,target:a.id}),this.addingEdge=!0)}},onMouseMove:function(e){e.preventDefault();var t={x:e.x,y:e.y};this.addingEdge&&this.edge&&this.graph.updateItem(this.edge,{target:t})},onMouseUp:function(e){e.preventDefault();var t=e.item,n=this.graph;if(t&&!t.destroyed&&"node"===t.getType()){var a=t.getModel();console.log(a),this.addingEdge&&this.edge&&(n.updateItem(this.edge,{target:a.id}),this.edge=null,this.addingEdge=!1)}else this.addingEdge&&this.edge&&(n.removeItem(this.edge),this.edge=null,this.addingEdge=!1)},onNodeClick:function(e){e.preventDefault();var t=this.graph,n=e.item;if(n){t.findAllByState("node","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.findAllByState("edge","click").forEach((function(e){t.setItemState(e,"click",!1)})),console.log("to click item",n),t.setItemState(n,"click",!0);var a=n.getModel();c({id:a.id,node:n,label:a.label})}},onEdgeClick:function(e){e.preventDefault();var t=this.graph,n=e.item;t.findAllByState("node","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.findAllByState("edge","click").forEach((function(e){t.setItemState(e,"click",!1)})),t.setItemState(n,"click",!0);var a=n.getModel();console.log(a),c({id:a.id,node:n,label:a.label||""})}}),Object(a.useEffect)((function(){var a,o,r=new g.Minimap({container:t.current,size:[200,160]}),i=new g.Grid,l=new g.ToolBar,c=new g.Menu({getContent:function(e){return console.log("graph",e),"<span>\u5220\u9664</span>"},handleMenuClick:function(e,t){var a,o=t.getID(),r=t.getType();if("edge"===r)null===(a=n.current)||void 0===a||a.removeItem(t);else if("node"===r){var i,l,c=[];null===(i=n.current)||void 0===i||i.getEdges().forEach((function(e){e.getTarget().getID()!==o&&e.getSource().getID()!==o||c.push(e)})),console.log(c),c.forEach((function(e){var t;null===(t=n.current)||void 0===t||t.removeItem(e)})),null===(l=n.current)||void 0===l||l.removeItem(t)}},offsetX:16,offsetY:40,itemTypes:["node","edge"]});n.current=new p.a.Graph({container:e.current,enabledStack:!0,maxStep:20,width:(null===(a=e.current)||void 0===a?void 0:a.scrollWidth)||1e3,height:(null===(o=e.current)||void 0===o?void 0:o.scrollHeight)||800,layout:{type:"dagre",rankdir:"TB",ranksep:30,"\u7c7b\u578b":30},plugins:[i,r,l,c],modes:{default:["drag-node","drag-point-add-edge"]},defaultNode:{style:{fill:"#FFF"},linkPoints:{top:!0,right:!0,bottom:!0,left:!0,size:10,fill:"#fff"}},nodeStateStyles:{click:{fill:"#C6E5FF"}},defaultEdge:{type:"polyline",style:{stroke:"#F6BD16",lineAppendWidth:10}},edgeStateStyles:{click:{lineWidth:5}}}),n.current.data(v),n.current.render()}),[v]);var E=function(e,t){if(t&&t.x>160&&t.y>50){var a,o="id-".concat(j++),r="common"===(l=e.name)?{type:"circle",size:80,style:{stroke:"blue",fill:"#FFF"}}:"start"===l?{type:"rect",size:[80,40],style:{fill:"#FFF",stroke:"red"}}:"juge"===l?{type:"diamond",size:80,style:{fill:"#FFF",stroke:"yellow"}}:void 0,i=Object(d.a)({},r,{id:o,x:t.x-120,y:t.y-10,anchorPoints:[[.5,0],[1,.5],[.5,1],[0,.5]],label:e.name});null===(a=n.current)||void 0===a||a.addItem("node",i)}var l};return o.a.createElement("div",{className:D.a.home},o.a.createElement("header",null,"\u6d41\u7a0b\u7f16\u8f91\u5668 \xa0\xa0\xa0",o.a.createElement("button",{onClick:function(){if(n.current){console.log(n.current.save());var e=n.current.save();n.current.read(e)}}},"\u5bf9\u9f50"),"\xa0\xa0",o.a.createElement("button",{onClick:function(){var e;console.log(null===(e=n.current)||void 0===e?void 0:e.save())}},"show Data")),o.a.createElement("div",{className:D.a["content-wrapper"]},o.a.createElement("div",{className:D.a["tool-box"]},o.a.createElement("ul",null,o.a.createElement(h,{name:"start",onDragEnd:E},o.a.createElement("div",{className:m()(D.a["node-start"],D.a.node)},"\u8d77\u70b9")),o.a.createElement(h,{name:"common",onDragEnd:E},o.a.createElement("div",{className:m()(D.a["node-common"],D.a.node)},"\u5e38\u89c4")),o.a.createElement(h,{name:"juge",onDragEnd:E},o.a.createElement("div",{className:m()(D.a["node-juge"],D.a.node)},o.a.createElement("span",null,"\u5224\u65ad"))))),o.a.createElement("div",{id:"editor-wrapper",className:D.a["editor-wrapper"]},o.a.createElement(y,null,o.a.createElement("div",{className:D.a["canvas-wrapper"],ref:e}))),o.a.createElement("div",{className:D.a["info-wrapper"]},o.a.createElement("div",{ref:t,className:"minimap-container"}),l.id?o.a.createElement("div",{className:D.a["info-editor"]},o.a.createElement("h4",null,"\u7f16\u8f91"),o.a.createElement("div",{className:D.a.row},o.a.createElement("label",null,"\u8282\u70b9\u540d\u79f0:"),o.a.createElement("input",{value:l.label,onChange:function(e){c(Object(d.a)({},l,{label:e.target.value}))}})),o.a.createElement("div",{className:D.a["btn-wrapper"]},o.a.createElement("button",{onClick:function(e){var t;e.preventDefault(),null===(t=n.current)||void 0===t||t.updateItem(l.node,{label:l.label})}},"\u4fdd\u5b58"))):null)))};n(44),n(45);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(l.a,{backend:c.a},o.a.createElement(I,null))),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.e6882097.chunk.js.map